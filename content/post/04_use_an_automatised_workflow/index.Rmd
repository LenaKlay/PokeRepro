---
title: "Create an automatised workflow: using make.R or the targets package "
author: "Camille Magneville"
date: 2021-12-02
categories: ["R"]
tags: ["Reproducible_Research"]
---


## Why using an automatised workflow? 


When you are coding, your life is a succession of: launching your code, 
waiting while it runs, discovering an issue and ... restarting from scratch: 

![](index_files/images/poke_crying.jpg){width=200px}


So, to make your code life easier you can **automatised your worklow so that 
re-running all your analysis only consist in running one file**!


Dependencies between the different steps of your analysis workflow have to be 
stated by using a `make.R` file <span style="color: grey;">(easy if your 
worklow is linear that is to say if one step leads to another unique one)</span> or <span style="color: purple;">the targets package</span> <span style="color: grey;">(easier to use than the `make.R` file if your worklow is not linear)</span>


In this tutorial, we will see the two methods starting with the `make.R` file. 
**We assumed that you have already done the** *03 - Create and define your first R function and analysis script* 



## Using the `make.R` file


In the tutorial *01 Let's Create a Research Compendium!*, you have already 
created a `make.R` file on the project root.  If not, you can create it by using:


```{r, eval = FALSE}
# Command to create a make.R file on the project root if not done before:
file.create("make.R")

```


This file will contains everything needed to run your project: for instance
loading the dependencies your project relies on, functions you have coded, 
sourcing scripts containing code for your analysis *etc.*


<span style="color: aquamarine;">##### 1 - Load the data and depencies </span> 


The first thing to code in the `make.R` file is to **automatise the data loading**.  
To do so you must use <span style="color: purple;">the here package</span> 
([link to the here website](https://here.r-lib.org/)): it helps to use **relative paths** 
(defined on the project root) instead of absolute ones as everyone as a different 
absolute path. 

<span style="color: grey;">*In our example*, we will load the *Pokemon* dataset, which is in the `data folder` on the project root.  
We use </span> <span style="color: purple;">the here() function of the here package</span> </span> <span style="color: grey;">: the different arguments = parameters of the function are the folders of the path leading to the file and the name of the file to open as follows: </span> 


```{r, eval = FALSE}
 # give the relative path to the data and read the data:
  # data_poke <- readr::read_csv(
  #   here::here("data", "pokemon.csv")
  # )
```



tous les chemins relatifs sont définis à la racine (répertoire qui contient tout le reste) du projet dans le fichier make.R (aide: package here avec la fonction here() à qui on donne un chemin relatif et la fonction reconstruit un chemin absolu: donc marche chez tout le monde car ide relatif mais absolu différent) -> utiliser les Projets R qui utilisent la racine du projet comme répertoire de travail -> pas de setwd(), on créé des RProjects!


